<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Posts Feed</title>
    <!-- Use Inter font for a modern look and feel -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
    <script src="./3.4.17.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: #f3f4f6;
            margin: 0;
            /* Flexbox layout to correctly position the navbar and posts */
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden; /* Hide the main scrollbar */
        }
        
        /* Custom styles to hide the scrollbar for all major browsers */
        .posts-container::-webkit-scrollbar {
            display: none; /* Hide scrollbar for Chrome, Safari and Opera */
        }
        .posts-container {
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }

        .posts-container {
            /* Enable vertical scrolling and scroll snapping */
            overflow-y: scroll;
            -webkit-overflow-scrolling: touch; /* Smoother scrolling on iOS */
            scroll-snap-type: y mandatory; /* The magic for snapping to posts */
            scroll-behavior: smooth; /* Smooth scroll between snaps */
            flex: 1; /* Take up all available space */
        }

        .post-wrapper {
            width: 100%;
            height: 100%; /* Ensure each post fills the container height */
            position: relative;
            scroll-snap-align: start; /* Snap each post to the top of the container */
            flex-shrink: 0; /* Prevent posts from shrinking */
        }

        .post-image {
            object-fit: cover;
            width: 100%;
            height: 100%;
        }

        .post-overlay {
            background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 50%, transparent 100%);
        }

        .profile-pic {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid white; /* Add a white border to the profile pic */
        }

        .swipe-indicator {
            position: fixed; /* Use fixed positioning to keep it in place */
            right: 1.5rem;
            top: 50%;
            transform: translateY(-50%);
            z-index: 50;
            display: flex;
            flex-direction: column;
            gap: 8px; /* Spacing between dots */
        }

        .swipe-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: rgba(255,255,255,0.5); /* Semi-transparent white */
            transition: all 0.3s ease;
        }

        .swipe-dot.active {
            background: #fff;
            transform: scale(1.2);
            box-shadow: 0 0 8px rgba(255,255,255,0.8);
        }
        
        /* Interactive element styling */
        .like-btn, .comment-btn, .share-btn {
            color: white;
            transition: transform 0.2s ease, color 0.2s ease;
        }
        
        .like-btn:hover, .comment-btn:hover, .share-btn:hover {
            transform: scale(1.1);
        }
        
        .like-btn.liked {
            color: #ef4444; /* Red color for liked posts */
            transform: scale(1.2);
        }

        /* Styling for the captions */
        .read-more-btn {
            color: #d1d5db; /* Light gray for the button text */
            text-decoration: none;
            font-weight: 500;
        }

        .read-more-btn:hover {
            color: #e5e7eb;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="bg-white border-b border-gray-200 px-4 py-3 flex items-center justify-left w-full z-50 flex-shrink-0">
        <h1 class="text-xl font-semibold text-gray-800">Posts</h1>
    </nav>

    <!-- Posts Container -->
    <div class="posts-container" id="postsContainer">
        <!-- Post 1 -->
        <div class="post-wrapper bg-gray-100 relative">
            <img loading="lazy" 
                class="post-image w-full h-full" 
                src="./slide1-wc.jpg"
                alt="Welcome Poster"
                onerror="this.src='./slide1-wc.jpg'">
            <div class="post-overlay absolute inset-0"></div>
            
            <!-- Post Content -->
            <div class="absolute bottom-0 left-0 right-0 p-4 text-white">
                <!-- User Info -->
                <div class="flex items-center mb-3">
                    <img loading="lazy" src="./azanLK.png" alt="User" class="profile-pic mr-3" onerror="this.src='./azanLK.png'">
                    <div>
                        <p class="font-semibold text-sm">AzanLK</p>
                        <p class="text-xs opacity-75">Just now</p>
                    </div>
                </div>
                
                <!-- Caption -->
                <div class="mb-3">
                    <p class="text-sm leading-relaxed">
                        <span class="caption-preview"> Welcome to <strong>azanLK</strong> ðŸŒ™ Scroll down to discover inspiring Hadiths, Islamic videos, and daily reminders...</span>
                        <span class="caption-full hidden">Welcome to <strong>azanLK</strong> ðŸŒ™ Your trusted place for spiritual growth and Islamic inspiration. Scroll down to explore daily Hadiths, heart-touching reminders, motivational Islamic videos, and more. Let the light of Iman guide your heart â€“ every scroll brings you closer to peace and purpose. Stay updated, stay inspired, and let every visit bring you closer to Allah. ðŸ¤²</span>
                        <button class="read-more-btn ml-1 font-medium">read more</button>
                    </p>
                </div>
                
                <!-- Actions -->
                <div class="flex items-center space-x-4">
                    <button class="like-btn flex items-center space-x-1" data-post="1">
                        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"/>
                        </svg>
                        <span class="like-count text-sm">0</span>
                    </button>
                    <button class="comment-btn flex items-center space-x-1">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                        </svg>
                        <span class="text-sm">0</span>
                    </button>
                    <button class="share-btn">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.684 13.342C8.886 12.938 9 12.482 9 12c0-.482-.114-.938-.316-1.342m0 2.684a3 3 0 110-2.684m0 2.684l6.632 3.316m-6.632-6l6.632-3.316m0 0a3 3 0 105.367-2.684 3 3 0 00-5.367 2.684zm0 9.316a3 3 0 105.367 2.684 3 3 0 00-5.367-2.684z"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>

        

    <script>
        class PostsFeed {
            constructor() {
                this.container = document.getElementById('postsContainer');
                this.posts = this.container.querySelectorAll('.post-wrapper');
                this.indicators = document.querySelectorAll('.swipe-dot');
                this.currentIndex = 0;
                this.likedPosts = new Set();
                this.isScrolling = false;
                this.lastScrollTop = 0;

                // Initialize the feed
                this.init();
            }
            
            init() {
                this.setupEventListeners();
                this.updateIndicators();
            }
            
            setupEventListeners() {
                // Listen for native scroll events to update the indicators and collapse captions
                this.container.addEventListener('scroll', this.handleScroll.bind(this));
                
                // Use a 'click' event listener on the container to delegate events
                this.container.addEventListener('click', this.handleClick.bind(this));
                
                // Add a click listener for images to collapse captions
                this.posts.forEach(post => {
                    const image = post.querySelector('.post-image');
                    image.addEventListener('click', this.collapseAllCaptions.bind(this));
                });

                // Keyboard navigation for desktop
                document.addEventListener('keydown', this.handleKeyDown.bind(this));
            }

            // Handles all click events on the container
            handleClick(e) {
                const target = e.target;

                // Handle read more button clicks
                if (target.classList.contains('read-more-btn')) {
                    this.handleReadMore(target);
                }

                // Handle like button clicks
                const likeBtn = target.closest('.like-btn');
                if (likeBtn) {
                    this.handleLike(likeBtn);
                }
            }
            
            // Updates indicators and collapses captions on scroll
            handleScroll() {
                // Throttle scroll events to prevent performance issues
                if (!this.isScrolling) {
                    window.requestAnimationFrame(() => {
                        const postHeight = this.posts[0].clientHeight;
                        const newIndex = Math.round(this.container.scrollTop / postHeight);
                        
                        // Check if the scroll position has actually changed to a new post
                        if (newIndex !== this.currentIndex) {
                            this.currentIndex = newIndex;
                            this.updateIndicators();
                            this.collapseAllCaptions();
                        }
                        this.isScrolling = false;
                    });
                    this.isScrolling = true;
                }
            }

            // Collapses all expanded captions across all posts
            collapseAllCaptions() {
                const readMoreButtons = document.querySelectorAll('.read-more-btn');
                readMoreButtons.forEach(button => {
                    const postContent = button.closest('.post-wrapper');
                    const preview = postContent.querySelector('.caption-preview');
                    const full = postContent.querySelector('.caption-full');
                    
                    if (!full.classList.contains('hidden')) {
                        full.classList.add('hidden');
                        preview.classList.remove('hidden');
                        button.textContent = 'read more';
                    }
                });
            }
            
            // Toggles the 'liked' state of a post
            handleLike(likeBtn) {
                const postId = likeBtn.getAttribute('data-post');
                const likeCount = likeBtn.querySelector('.like-count');
                
                if (this.likedPosts.has(postId)) {
                    // Unlike
                    this.likedPosts.delete(postId);
                    likeBtn.classList.remove('liked');
                    likeCount.textContent = parseInt(likeCount.textContent) - 1;
                } else {
                    // Like
                    this.likedPosts.add(postId);
                    likeBtn.classList.add('liked');
                    likeCount.textContent = parseInt(likeCount.textContent) + 1;
                }
            }
            
            // Toggles between a caption preview and the full caption
            handleReadMore(button) {
                const postContent = button.closest('.post-wrapper');
                const preview = postContent.querySelector('.caption-preview');
                const full = postContent.querySelector('.caption-full');
                
                if (full.classList.contains('hidden')) {
                    // Expand
                    preview.classList.add('hidden');
                    full.classList.remove('hidden');
                    button.textContent = 'read less';
                } else {
                    // Collapse
                    full.classList.add('hidden');
                    preview.classList.remove('hidden');
                    button.textContent = 'read more';
                }
            }

            // Navigates between posts using keyboard arrows
            handleKeyDown(e) {
                switch(e.key) {
                    case 'ArrowUp':
                        e.preventDefault();
                        this.prevPost();
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        this.nextPost();
                        break;
                }
            }
            
            // Scrolls to the next post
            nextPost() {
                if (this.currentIndex < this.posts.length - 1) {
                    const postHeight = this.posts[0].clientHeight;
                    this.container.scrollTo({
                        top: (this.currentIndex + 1) * postHeight,
                        behavior: 'smooth'
                    });
                }
            }
            
            // Scrolls to the previous post
            prevPost() {
                if (this.currentIndex > 0) {
                    const postHeight = this.posts[0].clientHeight;
                    this.container.scrollTo({
                        top: (this.currentIndex - 1) * postHeight,
                        behavior: 'smooth'
                    });
                }
            }
            
            // Visually updates the swipe indicators
            updateIndicators() {
                this.indicators.forEach((indicator, index) => {
                    if (index === this.currentIndex) {
                        indicator.classList.add('active');
                        indicator.classList.remove('inactive');
                    } else {
                        indicator.classList.add('inactive');
                        indicator.classList.remove('active');
                    }
                });
            }
        }
        
        // Initialize the posts feed when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new PostsFeed();
        });
    </script>
</body>
</html>
